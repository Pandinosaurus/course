<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>QPython中的WEB框架</title>
<link rel="stylesheet" href="../../static/style.css" type="text/css" />
<link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
<script type="text/javascript">
var DOCUMENTATION_OPTIONS = {
URL_ROOT:    '../../',
VERSION:     '0.9',
COLLAPSE_INDEX: false,
FILE_SUFFIX: '.html',
HAS_SOURCE:  true
};
</script>
<script type="text/javascript" src="../../static/jquery.js"></script>
<script type="text/javascript" src="../../static/underscore.js"></script>
<script type="text/javascript" src="../../static/doctools.js"></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
</head>
<body role="document">
<main class="contain">
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<div class="section" id="qpythonweb">
<h1>QPython中的WEB框架<a class="headerlink" href="#qpythonweb" title="Permalink to this headline">¶</a></h1>
<p>基于WEB开发框架，我们能够高效迅速地开发出一个WEB应用，同样，在QPython中你能用下列WEB框架来QPython进行快速WebApp开发。</p>
<div class="section" id="bottle">
<h2>Bottle<a class="headerlink" href="#bottle" title="Permalink to this headline">¶</a></h2>
<p>Bottle是QPython内置的WebApp开发框架，无需额外安装。你只需要遵循WebApp的规范，以及参考bottle开发的方法就可以进行。来看一个最简单的bottle的Hello world.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#qpy:webapp:Bottle Sample</span>
<span class="c1">#qpy://127.0.0.1:8080/hello/qpython</span>
<span class="kn">from</span> <span class="nn">bottle</span> <span class="k">import</span> <span class="n">route</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">template</span>
<span class="nd">@route</span><span class="p">(</span><span class="s1">&#39;/hello/&lt;name&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="k">return</span> <span class="n">template</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;Hello {{name}}&lt;/b&gt;!&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="nd">@route</span><span class="p">(</span><span class="s1">&#39;/__exit&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exit</span><span class="p">():</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">signal</span>
<span class="n">os</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGKILL</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="tornado">
<h2>Tornado<a class="headerlink" href="#tornado" title="Permalink to this headline">¶</a></h2>
<p>QPython同样支持Tornado这个高效支持异步通信的Web框架，您可以通过QPYPI来安装它。安装完毕之后，同样可以参考以下方式实现一个WebApp的Hello world。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#qpy:webapp:Tornado Sample</span>
<span class="c1">#qpy://127.0.0.1:8080/</span>
<span class="kn">import</span> <span class="nn">tornado</span>
<span class="kn">import</span> <span class="nn">tornado.web</span>
<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Hello, world&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ExitHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">signal</span>
<span class="n">os</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGKILL</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">make_app</span><span class="p">():</span>
<span class="k">return</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
<span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
<span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/__exit&quot;</span><span class="p">,</span> <span class="n">ExitHandler</span><span class="p">),</span>
<span class="p">])</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">make_app</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8080</span><span class="p">)</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="django">
<h2>Django<a class="headerlink" href="#django" title="Permalink to this headline">¶</a></h2>
<p>作为Python WEB开发的最常用框架，Django同样获得了QPython的支持, 您可以直接通过QPYPI的“INSTALL WITH PYTHON PYPI&#8221;来安装Django，安装完之后，为了快速实现Django 的HELLO WORLD,您需要通过TOOLS里的Django manage script来新建一个项目，新建完项目后即可通过编辑器来编辑对应的views.py来实现Hello world。</p>
</div>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
</main>
<footer>
<img onclick="openPurchase()" src="../../static/star.jpg">
<div id="praise"><span>0</span> persons have rewarded</div>
</footer>
<script>
var milib;
if (milib==undefined) {
var milib = function(){
};
milib.qeditor = function(str){
alert('please open it with QPython browser')
};
milib.getPurchaseNumber = function(str){
//alert('getPurchaseNumber:'+str)
return "10+";
};
milib.a8playVideoFromGW= function(url){
window.open(url)
};
milib.qpylibinstall = function(cat,url,target){
window.open(url)
};
milib.gotoIfPay = function(url, packageId, packageUrl){
window.open(url)
};
} else {
}
function openPurchase() {
//获取标识
var u = window.location.href.split('/')
var s = u[u.length-1].replace('.html', '')
s = u[u.length-2]+'-'+s
milib.openPurchaseActivity(s)
}
//按钮事件
function btnEvent(){
var a = this.parentElement.getElementsByTagName('pre')
if ( a && a.length == 1){
/**********有代码，调用控制台*************/
var code = a[0].lastChild.nodeValue
milib.qeditor(code)
}else{
//没有代码，调转
var url = this.getAttribute('data-url');
window.open(url);
}
}
//获取赞赏
function setPraise(){
var u = window.location.href.split('/')
var s = u[u.length-1].replace('.html', '')
s = u[u.length-2]+'-'+s
var i = document.getElementById('praise').getElementsByTagName('span')[0]
var num = milib.getPurchaseNumber(s);
i.innerHTML = num
}
//初始化代码显示
function initCode(){
var prearr = document.getElementsByTagName('pre');
for (var i = 0; i < prearr.length; i++) {
var temp_data = prearr[i].lastChild.nodeValue
//正则处理 lavel5
temp_data = temp_data.replace(/\^2\$/g, spaceString(2));
temp_data = temp_data.replace(/\^4\$/g, spaceString(4));
temp_data = temp_data.replace(/\^6\$/g, spaceString(6));
temp_data = temp_data.replace(/\^8\$/g, spaceString(8));
temp_data = temp_data.replace(/\^10\$/g, spaceString(10));
temp_data = temp_data.replace(/\^12\$/g, spaceString(12));
temp_data = temp_data.replace(/\^16\$/g, spaceString(16));
temp_data = temp_data.replace(/\^20\$/g, spaceString(20));
//set
prearr[i].lastChild.nodeValue = temp_data;
}
}
//产生空格
function spaceString(num){
var v = ''
for (var i = 0; i < num; i++) {
v += ' ';
}
return v;
}
window.onload = function(){
setPraise();
initCode();
//将所有的button绑定事件
var b = document.getElementsByTagName('button');
for (var i = 0; i < b.length; i++) {
b[i].onclick = btnEvent;
}
}
</script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-103260045-3', 'auto');
ga('send', 'pageview');
</script>
</body>
</html>
